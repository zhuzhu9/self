# 单片机（MCU）系统构架

[TOC]



## 简介

单片微型计算机简称单片机，简单来说就是集CPU（运算、控制）、RAM（数据存储-内存）、ROM（程序存储）、输入输出设备（串口、并口等）和中断系统处于同一芯片的器件

在我们自己的个人电脑中，CPU、RAM、ROM、I/O这些都是单独的芯片，然后这些芯片被安装在一个主板上，这样就构成了我们的PC主板，进而组装成电脑，而单片机只是将这所有的集中在了一个芯片上而已（一个集成封装样式的芯片就是一台pc，开发板电路板不包含在内）。

## 51

### 一、整体架构

![img](图片/单片机嵌入式系统构架.assets/8d5494eef01f3a29b4520f1d9725bc315d607c4f)

分为内核（IP核）和片上外设两部分组成

内核是图中的CPU

片上外设是图中的时钟电路、SFR和RAM、ROM、定时/计数器、并行I/O口、串行I/O口、中断系统。

IP核跟外设之间由系统总线连接，且是8bit的，速度有限。

51内核是上个世纪70年代Intel公司设计的，速度只有12M，外设是IC厂商（STC）在内核的基础上添加的，不同的IC厂商会在内核上添加不同的外设，从而设计出各具特色的单片机。这里Intel属于IP核厂商，STC属于IC厂商。

编程的时候操作的寄存器位于SFR和RAM这个部分，其中SFR（特殊功能寄存器）占有 128字节（实际上只用了 26 个字节，只有 26 个寄存器，其他都属于保留区），RAM占有 128 字节，我们在程序中定义的变量就是放在RAM中。其中SFR和RAM在地址上是重合的，都是在80~FF地址区间，但在物理区间上是分开的，所以51的RAM是有256个字节。

编写好的程序是烧写到ROM区。

### 二、CPU结构

![在这里插入图片描述](图片/单片机嵌入式系统构架.assets/20200202121155655.png)

### 三、特性

1、从内部的硬件到软件有一套完整的按位操作系统，称作**位处理器**（CPU），处**理对象不是字或字节而是位**。不但能对片内某些特殊功能寄存器的某位进行处理，如传送、置位、清零、测试等，还能进行位的逻辑运算，其功能十分完备，使用起来得心应手。

2、同时在片内RAM区间还特别开辟了一个**双重功能的地址区间**，使用极为灵活，这一功能无疑给使用者提供了极大的方便，

3、**乘法和除法指令**，这给编程也带来了便利。很多的八位单片机都不具备乘法功能，作乘法时还得编上一段子程序调用，十分不便。

## STM32

### 一、整体架构

![【STM32】STM32系统架构浅析](图片/单片机嵌入式系统构架.assets/v2-8f9d8982ad1d4535836becb83de27505_1440w.jpg)

也是由内核和片上外设组成

ARM属于IP核厂商，ARM给ST授权，ST公司在Cortex-M3内核的基础上设计出STM32单片机。

ARM公司提供的内核：cortex-M3

ARM公司提供的总线：Icode，Dcode，System总线

ST公司提供的总线矩阵，DMA控制器，AHB总线，APB总线，以及各个外设控制器

以上整体称之为片上系统(SOC)

1、内核

只是STM32使用的Cortex-M3内核比51复杂得多，优秀得多，支持的外设也比51多得多，同时总线宽度也上升到32bit，无论速度、功耗、外设都强于51。

2、总线

对比51内核只有一种总线，Cortex-M3内部有若干个总线接口，以使CM3能同时取址和访内（访问内存）：

**指令存储区总线**（两条）、**系统总线**、**私有外设总线**。有两条代码存储区总线负责对代码存储区（即FLASH外设）的访问，分别是I-Code总线和D-Code总线。

**I-Code**用于取指，D-Code用于查表等操作，它们按最佳执行速度进行优化。

**系统总线**（System）用于访问内存和外设，覆盖的区域包括SRAM，片上外设，片外RAM，片外扩展设备，以及系统级存储区的部分空间。

**私有外设总线**负责一部分私有外设的访问，主要就是访问调试组件。它们也在系统级存储区。

**DMA总线**，DMA是data memory  access，是一种连接内核和外设的桥梁，它可以访问外设、内存，传输不受CPU的控制，并且是双向通信。简而言之，就是一个速度很快的且不受老大控制的数据搬运工，这个在51里面是没有的。

2、外设

STM32比51的外设多得多，除了串口、定时器、IO口等共有的，还有一些独有的如FSMC、SDIO、SPI、I2C等，这些外设按照速度的不同，分别挂载到AHB、APB2、APB1这三条总线上。

### 二、特性

1、内核：ARM32位Cortex-M3CPU，最高工作频率72MHz，1.25DMIPS/MHz，单周期乘法和硬件除法

2、存储器：片上集成32-512KB的Flash存储器。6-64KB的SRAM存储器

3、时钟、复位和电源管理：2.0-3.6V的电源供电和I/O接口的驱动电压。POR、PDR和可编程的电压探测器（PVD）。4-16MHz的晶振。内嵌出厂前调校的8MHz RC振荡电路。内部40 kHz的RC振荡电路。用于CPU时钟的PLL。带校准用于RTC的32kHz的晶振

4、调试模式：串行调试（SWD）和JTAG接口。最多高达112个的快速I/O端口、最多多达11个定时器、最多多达13个通信接口。

# 参考

[51与STM32单片机架构（内核和片上外设）的区别汇总+拓展](https://blog.csdn.net/SUR0608/article/details/104142804)

[【STM32】STM32系统架构浅析](https://zhuanlan.zhihu.com/p/92669003)













